# 3 курс
# Верешко Егор Дмитриевич
# Проектная работа "Веб-ларек"
Описание: Web-ларёк - интернет-магазин с товарами для веб-разработчиков. В нём можно посмотреть каталог товаров, добавить товары в корзину и сделать заказ.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

## Архитектура проекта
В данном проекте используется архитектурный паттерн MVP (Model-View-Presenter).
- Model: Логика отвечает за управление данными для корзины и каталога. Классы для корзины (Basket), список всех товаров (Catalog).
- View: Отображает данные в пользовательском интерфейсе приложения. Используется брокер событий для взаимодействия всех частей приложения.
- Presenter. Отвечает за обработку событий, взаимодействие между Model и View, обновление представлений.

Базовые классы:
1. Класс Api

Предназначение - Предоставляет базовый функционал для взаимодействия с API, абстрагируя работу с HTTP запросами.

Функции:
Конструктор принимает аргументы:
- baseUrl: string - базовый URL API
- options: RequestInit - опции запросов
// Пример использования класса Api:
const api = new Api('https://api.example.com', {
    headers: { 'Authorization': 'Bearer api-token' } //  Пример заголовка с токеном
});

Класс принимает такие методы:
- handleResponse - обрабатывает ответ от API, проверяет статус ответа и преобразует его в JSON
- get - выполняет GET запрос к API, получение значения
- post - выполняет POST, PUT или DELETE запрос к API

Также класс реализует типы:
- ApiListResponse<Type> - представляет структуру ответа API, которая содержит общее количество элементов total: number и массив самих элементов items: Type[]
- ApiPostMethods - определяет допустимые методы HTTP-запросов для отправки данных (POST, PUT, DELETE)

2. Класс EventEmitter

Предназначение - Обеспечивает работу событий, позволяя другим частям приложения регистрировать обработчики на события и уведомлять их при возникновении события.

// Создание объекта EventEmitter
const eventEmitter = new EventEmitter();

Функции:
Конструктор - создает хранилище для событий.
Конструктор инициализирует пустой объект Map, который будет использоваться для хранения всех событий и их обработчиков.  Когда вызываются методы класса EventEmitter, они используют _events для добавления, удаления и вызова обработчиков событий.

Класс принимает такие методы:
- on - устанавливает обработчик callback на событие eventName
// Регистрация обработчика на событие 'userLoggedIn'
eventEmitter.on('userLoggedIn', (user) => {
  console.log(`Пользователь ${user.name} вошел в систему.`);
});
- off - снимает обработчик callback с события eventName
- emit - инициирует событие eventName с данными data
- onAll - устанавливает обработчик callback для всех событий
// Регистрация обработчика на все события
eventEmitter.onAll((event) => {
  console.log(`Событие: ${event.eventName}, Данные: ${event.data}`);
});
- offAll - снимает все обработчики callback для всех событий
// Удаление всех обработчиков
eventEmitter.offAll();
- trigger - создаёт коллбек триггер, генерирующий событие eventName при вызове

Также класс реализует типы:
- EventName - объединяет тип string и тип выражения RegExp. Это позволяет использовать как строковые имена событий, так и регулярные выражения для подписки на события по шаблону
- Subscriber - функция Function, используется как тип для обработчиков событий
- EmitterEvent - тип описывает объект, который передается в обработчики событий, зарегистрированных с помощью onAll. Содержит имя события eventName: string и данные data: unknown, которые были переданы при вызове emit

Также класс реализует интерфейсы:
- IEvents - определяет три метода (on, emit, trigger), отвечающих за работу с событиями, предоставляет необходимый набор функций для работы с событиями

## Слои MVP-паттерна
1. Модель данных (Model) - управление состоянием корзины, хранение и предоставление доступа к списку товаров в каталоге.
Функции:
- add - добавление товара с id в корзину
- remove - удаление товара с id из корзины
- _changed() - генерация события, уведомляющее об изменении состояния корзины
- setItems - устанавливает список товаров в каталоге
- getProduct - получение информации о конкретном товаре по id

2. Отображение (представление) - отображение элементов корзины.
Функции:
- render - принимает данные (data) для отображения и возвращает HTML-элемент, содержащий отрисованный контент

3. Компонент - связывает Model и View.
Функции:
- взаимодействие с внешним API
- публикация и подписка на события в приложении